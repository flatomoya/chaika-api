<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=1020">
    <title>設定項目の解説 - 2ch API extension for chaika</title>

    <!-- stylesheet delivered from https://github.com/sindresorhus/github-markdown-css -->
    <link href="./github-markdown.css" media="all" rel="stylesheet">
    <style>
      .markdown-body {
        box-sizing: border-box;
        min-width: 200px;
        max-width: 980px;
        margin: 0 auto;
        padding: 20px;
      }
    </style>
  </head>

  <body>
    <!-- Last Modified : 2017/04/23 05:29:03 -->
      <div class="markdown-body">
        <h2>
<a id="2ch-api-extension-for-chaika---設定項目の解説" class="anchor" href="#2ch-api-extension-for-chaika---%E8%A8%AD%E5%AE%9A%E9%A0%85%E7%9B%AE%E3%81%AE%E8%A7%A3%E8%AA%AC"><svg class="octicon octicon-link" height="16" width="16"><path id="octicon" fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>2ch API extension for chaika - 設定項目の解説</h2>
<p>ここでは、2ch API 設定ウィンドウ内の各設定項目の詳細を解説しています。初期設定のしかたについては <a class="internal present" href="./api-readme.html">付属文書(README)</a> を参照してください。</p>
<h3>
<a id="目次" class="anchor" href="#%E7%9B%AE%E6%AC%A1"><svg class="octicon octicon-link" height="16" width="16"><use xlink:href="#octicon"/></svg></a>目次</h3>
<ul>
<li>
<a href="#%E8%A8%AD%E5%AE%9A%E3%82%A6%E3%82%A3%E3%83%B3%E3%83%89%E3%82%A6%E4%B8%8A%E9%83%A8">設定ウィンドウ上部</a>
<ul>
<li>「2ch API を使用する」</li>
<li>「ツール/ヘルプ」 ⇒ <a href="#%E5%8F%B3%E4%B8%8A%E3%81%AE%E3%83%84%E3%83%BC%E3%83%AB%E3%83%98%E3%83%AB%E3%83%97%E3%83%A1%E3%83%8B%E3%83%A5%E3%83%BC%E3%83%9C%E3%82%BF%E3%83%B3">右上の「ツール/ヘルプ」メニューボタン</a>
</li>
</ul>
</li>
<li>
<a href="#%E8%AA%8D%E8%A8%BC%E3%82%BF%E3%83%96">「認証」タブ</a>
<ul>
<li>「AppKey」／「HMKey」</li>
<li>「CT」</li>
<li>「認証時にRoninのIDとパスワードも送信する」</li>
</ul>
</li>
<li>
<a href="#user-agent%E3%82%BF%E3%83%96">「User-Agent」タブ</a>
<ul>
<li>「各状況で送信される User-Agent」グループの４つの項目</li>
</ul>
</li>
<li>
<a href="#%E8%87%AA%E5%8B%95%E6%9B%B4%E6%96%B0%E3%82%BF%E3%83%96">「自動更新」タブ</a>
<ul>
<li>「セッションIDの自動更新」</li>
<li>「更新間隔」‥「認証に成功したとき」／「認証に失敗したとき」</li>
<li>「スリープ解除時の更新」‥「スリープ解除直後の待ち時間(秒)」</li>
</ul>
</li>
<li>
<a href="#%E8%A9%B3%E7%B4%B0%E3%82%BF%E3%83%96">「詳細」タブ</a>
<ul>
<li>「API URL」／「認証URL」</li>
<li>「APIドメイン」</li>
</ul>
</li>
<li>
<a href="#%E7%8A%B6%E6%85%8B%E3%83%86%E3%82%B9%E3%83%88%E3%82%BF%E3%83%96">「状態・テスト」タブ</a>
<ul>
<li>「現在のセッションID」</li>
<li>「前回の認証」</li>
<li>「セッションID取得」</li>
<li>「セッションID消去」</li>
</ul>
</li>
<li>
<a href="#%E5%8F%B3%E4%B8%8A%E3%81%AE%E3%83%84%E3%83%BC%E3%83%AB%E3%83%98%E3%83%AB%E3%83%97%E3%83%A1%E3%83%8B%E3%83%A5%E3%83%BC%E3%83%9C%E3%82%BF%E3%83%B3">右上の「ツール/ヘルプ」メニューボタン</a>
<ul>
<li>「すべての設定をファイルへ保存」／「KeyとUAのみをファイルへ保存」</li>
<li>「設定をファイルから読み込み」</li>
<li>「すべての設定を元に戻す」／「すべての設定を既定値に戻す」</li>
<li>「KeyとUAのみを消去」</li>
<li>「付属文書(README)」／「設定項目の解説」</li>
</ul>
</li>
</ul>
<h3>
<a id="設定ウィンドウ上部" class="anchor" href="#%E8%A8%AD%E5%AE%9A%E3%82%A6%E3%82%A3%E3%83%B3%E3%83%89%E3%82%A6%E4%B8%8A%E9%83%A8"><svg class="octicon octicon-link" height="16" width="16"><use xlink:href="#octicon"/></svg></a>設定ウィンドウ上部</h3>
<ul>
<li>
<p><strong>「2ch API を使用する」</strong></p>
<p>この 2ch API 機能を有効にし、2ch.net (5ch.net) BBS のdatファイル（ログ）を 2ch API 経由で取得します。<br>
この項目がOFFの場合は、2ch API 機能は無効になり、すべて従来どおりのdat直接アクセスになります。以下の設定欄も無効化され、設定値を入れることもできなくなります。</p>
</li>
<li>
<p><strong>「ツール/ヘルプ」</strong></p>
<p>⇒ <a href="#%E5%8F%B3%E4%B8%8A%E3%81%AE%E3%83%84%E3%83%BC%E3%83%AB%E3%83%98%E3%83%AB%E3%83%97%E3%83%A1%E3%83%8B%E3%83%A5%E3%83%BC%E3%83%9C%E3%82%BF%E3%83%B3">右上の「ツール/ヘルプ」メニューボタン</a></p>
</li>
</ul>
<h3>
<a id="認証タブ" class="anchor" href="#%E8%AA%8D%E8%A8%BC%E3%82%BF%E3%83%96"><svg class="octicon octicon-link" height="16" width="16"><use xlink:href="#octicon"/></svg></a>「認証」タブ</h3>
<ul>
<li>
<p><strong>「AppKey」／「HMKey」</strong></p>
<p>2ch API サーバーへのアクセスに必要な AppKey （アプリケーションキー） と HMKey （HMACキー） をここに設定します。</p>
<p>この２つは必須設定項目で、もしも、どちらかが未設定なら、2ch API を使用しない通常モード（dat直接アクセス）になります。これらの詳しい説明は <a class="internal present" href="./api-readme.html">付属文書(README)</a> の <a class="internal present" href="./api-readme.html#%E5%88%9D%E6%9C%9F%E8%A8%AD%E5%AE%9A%E3%81%AE%E3%81%97%E3%81%8B%E3%81%9F">初期設定のしかた</a> を参照してください。</p>
</li>
<li>
<p><strong>「CT」</strong></p>
<p>認証時に使用する CT の値を指定します。</p>
<p>通常は既定値の「UNIX時刻」のままで良く、設定変更の必要はありません。設定値としては「UNIX時刻」「ランダム値」「固定値」のいずれかを選べます。「固定値」を選んだ場合は右横の入力欄に1～10桁の数値を入れてください。10桁に満たない場合は自動的に先頭が0で埋められて使われます。</p>
</li>
<li>
<p><strong>「認証時にRoninのIDとパスワードも送信する」</strong></p>
<p>2ch API で Ronin（旧2ちゃんねるビューア●） を使用するかどうかを設定します。既定値はONです。</p>
<p>認証時に Ronin のアカウント情報も一緒に送信すると、2ch API サーバーから過去ログを取得できるようになります。Ronin のアカウントが chaika に登録されていない場合は、この設定項目は何の働きもしません（過去ログも取れません）。</p>
<p>アカウントの登録は chaika の設定の 「アカウント」→「浪人/●」（v1.7.0 以降） もしくは 「全般」→「2ch ビューア」（v1.6.3 以前） から行なってください。</p>
</li>
</ul>
<h3>
<a id="user-agentタブ" class="anchor" href="#user-agent%E3%82%BF%E3%83%96"><svg class="octicon octicon-link" height="16" width="16"><use xlink:href="#octicon"/></svg></a>「User-Agent」タブ</h3>
<ul>
<li>
<p><strong>「各状況で送信される User-Agent」グループの４つの項目</strong></p>
<p>2chのサーバーへアクセスする時、そのサーバーへ送られる User-Agent と X-2ch-UA の値（いわゆるUser-Agent名）を、それぞれの状況別に指定します。<br>
X-2ch-UA は2ch専用ブラウザ特有のものでインターネット標準ではありませんが、その目的は User-Agent と同じなので「User-Agent」として同じ場所にまとめています。</p>
<ul>
<li>「通常(datUA)」 ‥‥ dat取得時やその他の状況で送信する User-Agent を設定</li>
<li>「認証(authUA)」 ‥‥ 認証時に送信する User-Agent を設定</li>
<li>「投稿(postUA)」 ‥‥ 投稿（書き込み）時に送信する User-Agent を設定</li>
<li>「X-2ch-UA」 ‥‥ 認証時に送信する X-2ch-UA を設定</li>
</ul>
<p>User-Agent名とは「Mozilla/5.0 (Windows NT 6.1; rv:38.0)」のような短いテキスト（文字列値）で、ユーザーが使用しているソフトウェアが何なのかをサーバー側で識別できるようにするために、ユーザー側のソフトウェアが自己申告としてサーバーへ「名乗っている」名前のようなものです。</p>
<p>このUser-Agent名は通常であれば、ユーザーが自由に変更できる仕組みにはなっていないのが普通で、それぞれのソフトウェアごとに異なる名前が内部で固定的に割り当てられていて、上記のようにソフトウェアの識別に利用されています。</p>
<p>上記の４つの設定項目の目的は、他の2ch専用ブラウザが使用しているUser-Agent名をここに設定することで、chaika を他の2ch専用ブラウザに「見せかける」ことです。</p>
<p>これらの設定項目を空白のままにすると、User-Agent名は一切送信されませんが、認証やdat取得などができなくなるなどのトラブルが発生する可能性があります。実際、2015/05/10以降「投稿(postUA)」が空白の状態では2chへの書き込みができなくなっています。</p>
</li>
</ul>
<h3>
<a id="自動更新タブ" class="anchor" href="#%E8%87%AA%E5%8B%95%E6%9B%B4%E6%96%B0%E3%82%BF%E3%83%96"><svg class="octicon octicon-link" height="16" width="16"><use xlink:href="#octicon"/></svg></a>「自動更新」タブ</h3>
<ul>
<li>
<p><strong>「セッションIDの自動更新」</strong></p>
<p>dat取得に使用するセッションIDの有効期間は24時間しかありません。そのため、定期的に認証を行いセッションIDを更新し続ける必要があります。ここではその方法を指定します。</p>
<ul>
<li>
<p>「起動時のみ更新(自動更新しない)」<br>
セッションIDの自動更新を行いません。セッションID取得（認証）はFirefoxの起動時のみになります。</p>
</li>
<li>
<p>「APIサーバーへアクセスしたとき更新」<br>
datAPIサーバーへアクセスした（スレッドの内容を読み込んだ）ときに、前回のセッションID取得（認証）から所定の時間（下の「更新間隔」）が経過していれば、そのタイミングでセッションIDの更新を試みます。<br>
これがデフォルト（既定値）で、通常はこれで問題ありませんが、Firefoxを起動したまま2chのスレッドも読み込まず長時間放置した場合は、その後のスレッド読み込み時に最初の１回だけ「セッションID 無効」のエラーが出る場合があります。</p>
</li>
<li>
<p>「タイマーを使って一定間隔で更新」<br>
タイマーを動作させ、常に一定間隔（下の「更新間隔」）でセッションID取得（認証）を行います。<br>
このタイマーはFirefox起動中は常に動作していて、chaikaの使用状況や2chへのアクセスとは全く無関係のタイミングで自動的に更新を試みます。そのため、自動更新の手段としてはほぼ完璧になりますが、この方法は光ファイバーなどの常時接続環境で使用することが前提になります。</p>
</li>
</ul>
</li>
<li>
<p><strong>「更新間隔」‥「認証に成功したとき」／「認証に失敗したとき」</strong></p>
<p>「認証に成功したとき」は新しいセッションIDを取得できた場合にこの次に自動更新動作を行うまでの時間間隔を、「認証に失敗したとき」は何らかの理由（ネットワークの障害など）で認証ができなかったときに再度認証を試みるまでの時間間隔を、それぞれ指定します。</p>
<p>ここでいう成功・失敗は、自動更新による認証だけに限らず、ユーザーの手動操作による認証・Firefoxの起動時の認証などすべてのケースを含みます。</p>
<p>設定可能範囲は両方とも3分～24時間で、推奨される設定範囲は「成功したとき」が6時間～12時間・「失敗したとき」が30分～1時間です。既定値は「成功したとき」が12時間・「失敗したとき」が30分になっていて、これも特に理由がない限り変更する必要は無いでしょう。</p>
<p>これらの値に0を指定することもでき、0の場合は「自動更新を行わない」という意味になります。</p>
<p>認証に失敗した場合は、現在使用中のセッションIDを引き続き使用し続ける仕組みになっていますので、「失敗したとき」に極端に短い時間を指定する必要はありません。使用中のセッションIDの有効期限が切れるまでの間に1回成功すればいいのです。</p>
</li>
<li>
<p><strong>「スリープ解除時の更新」‥「スリープ解除直後の待ち時間(秒)」</strong></p>
<p>上の「セッションIDの自動更新」が「タイマー」の場合のみ意味を持ちます。</p>
<p>Firefoxを起動させたままパソコンをスリープ状態（サスペンド・休止状態など）にして、スリープ状態を解除させたとき、自動更新を行う予定だった時刻を既に過ぎてしまっている場合は、スリープ解除直後すぐに自動更新を試みます。その場合、この設定の秒数だけ待った後にセッションID取得動作を開始します。</p>
<p>この設定の必要性としては、特に Wi-Fi（無線LAN）を使ってインターネットを利用している場合は、スリープ解除直後から Wi-Fi の接続が確立されるまで数秒を要するためです。</p>
<p>初期値は10秒で、通常はこの初期値のままで問題はないでしょう。もし、スリープ解除直後のネット接続確立にこれ以上の時間がかかっているようでしたら、値を増やしてみてください。</p>
</li>
</ul>
<h3>
<a id="詳細タブ" class="anchor" href="#%E8%A9%B3%E7%B4%B0%E3%82%BF%E3%83%96"><svg class="octicon octicon-link" height="16" width="16"><use xlink:href="#octicon"/></svg></a>「詳細」タブ</h3>
<p>この「詳細」タブにある設定項目は、将来の 2ch.net (5ch.net) の仕様変更に備える目的で変更可能にしてあるものです。現時点では初期値から変更する必要はありませんし、不用意に変更すると正常に動作しなくなる場合もありますので注意してください。</p>
<ul>
<li>
<p><strong>「API URL」／「認証URL」</strong></p>
<p>「API URL」はdat取得APIサーバーURLを、「認証URL」は認証APIサーバーURLを、それぞれ指定します。初期値は、API URL が <code>https://api.5ch.net/v1/</code> 、認証URL が <code>https://api.5ch.net/v1/auth/</code> です。</p>
</li>
<li>
<p><strong>「APIドメイン」</strong></p>
<p>2ch API の動作対象となるドメインを指定します。複数を指定する場合は半角空白で区切ります。初期値は <code>2ch.net 5ch.net bbspink.com</code> です。2ch.net (5ch.net) の掲示板ドメインが追加・変更された場合にはここを変更してください。</p>
</li>
</ul>
<h3>
<a id="状態テストタブ" class="anchor" href="#%E7%8A%B6%E6%85%8B%E3%83%86%E3%82%B9%E3%83%88%E3%82%BF%E3%83%96"><svg class="octicon octicon-link" height="16" width="16"><use xlink:href="#octicon"/></svg></a>「状態・テスト」タブ</h3>
<ul>
<li>
<p><strong>「現在のセッションID」</strong></p>
<p>現在のセッションIDの状態と、セッションIDの取得日時、セッションIDそのもの(ID=...)を表示します。現在のセッションIDの状態は、以下のようなものがあります。</p>
<ul>
<li>「未取得」 ‥‥ セッションIDは未取得（未認証）</li>
<li>「取得済」 ‥‥ セッションIDは取得済みだが、それを使ってのスレッドの読み込みはまだ行なっていないため、セッションIDや鍵(AppKey/HMKey)の有効性は不明である状態。</li>
<li>「Key無効」 ‥‥ このセッションIDを使ってスレッドを読み込んでみたところ、「AppKey/HMKey 無効」のエラーが出た状態。</li>
<li>「無効」 ‥‥ このセッションIDを使ってスレッドを読み込んでみたところ、「セッションID 無効」のエラーが出た状態。セッションIDの有効期間（24時間）が既に過ぎている場合など。</li>
<li>「有効」 ‥‥ このセッションIDを使ってスレッドを読み込んでみたところ、正常にスレッド内容(dat)を取得できた状態。</li>
<li>「有効(Ronin)」 ‥‥ このセッションIDを使ってスレッドを読み込んでみたところ、正常にスレッド内容(dat)を取得できた状態。その上で、datAPIサーバーが"Ronin有効"を示すユーザーステータスを返してきた場合。過去ログも取得できることを表します。</li>
</ul>
</li>
<li>
<p><strong>「前回の認証」</strong></p>
<p>前回行われた認証の結果（未認証/成功/失敗）と、認証が行われた日時、そして失敗の場合は、何回連続で失敗しているかということと、失敗の原因の特定に役立つかもしれない各種ステータスメッセージを表示します。成功の場合は、この認証日時は上のセッションID取得日時と同じになります。失敗のステータスメッセージの典型例には以下のようなものがあります。</p>
<ul>
<li>「接続できません : https://api.5ch.net/v1/auth/ 」<br>
2chの認証サーバーに接続できない。ネットワークの接続状態に問題があるか、認証サーバーがダウンしているか、認証URLのホスト名部分に誤りがある可能性がある。</li>
<li>「HTTPステータス : 404 Not Found」<br>
2chの認証サーバーに何らかの問題が発生しているか、認証URLのパス名部分に誤りがある可能性がある。</li>
<li>「HTTPステータス : 500 Internal Server Error」<br>
2chの認証サーバーで何らかの内部エラーが発生した。失敗の原因としては現状ではもっとも発生する頻度が高いが、何度も連続して発生することは無いようです。</li>
<li>「サーバー応答 : ng (appkey incorrect length)」<br>
認証サーバーは動作しているがセッションIDを返して来なかった場合は「サーバー応答 : ～」という表示になり、認証サーバーが返してきた内容（エラーメッセージなど）をそのまま表示します。例の「ng (appkey incorrect length)」は、AppKey の文字数が正しくないことを意味します。</li>
</ul>
</li>
<li>
<p><strong>「セッションID取得」</strong></p>
<p>セッションID取得（認証）を手動で行うボタンです。<br>
取得に成功した場合は、「現在のセッションID」の内容は新しく取得したものに置き換わります。取得に失敗した場合は、「現在のセッションID」の内容はそのままで、「前回の認証」に失敗した原因を表すステータスメッセージが表示されます。</p>
</li>
<li>
<p><strong>「セッションID消去」</strong></p>
<p>現在のセッションIDと前回の認証に関する状態をすべて消去します。「現在のセッションID」「前回の認証」は、未取得・未認証になります。</p>
</li>
</ul>
<h3>
<a id="右上のツールヘルプメニューボタン" class="anchor" href="#%E5%8F%B3%E4%B8%8A%E3%81%AE%E3%83%84%E3%83%BC%E3%83%AB%E3%83%98%E3%83%AB%E3%83%97%E3%83%A1%E3%83%8B%E3%83%A5%E3%83%BC%E3%83%9C%E3%82%BF%E3%83%B3"><svg class="octicon octicon-link" height="16" width="16"><use xlink:href="#octicon"/></svg></a>右上の「ツール/ヘルプ」メニューボタン</h3>
<p>以上の設定の管理などに役立つ各種機能を呼び出せるメニューボタンです。<br>
このメニューをキーボード操作のみで開くには、TABキーを何度か押すなどしてこのボタンにキーボードフォーカスを持って行き、F4キー もしくは Alt(Option)+↓キー を押してください。</p>
<ul>
<li>
<p><strong>「すべての設定をファイルへ保存」／「KeyとUAのみをファイルへ保存」</strong></p>
<p>設定ウィンドウ内の現在の設定状態をテキストファイルにして保存します。「KeyとUAのみ～」は、認証タブの AppKey/HMKey と User-Agent タブの User-Agent ４項目のみを保存します。</p>
</li>
<li>
<p><strong>「設定をファイルから読み込み」</strong></p>
<p>上記の「すべての設定をファイルへ保存」「KeyとUAのみをファイルへ保存」で保存されたテキストファイルを読み込んで、設定状態を復元します。</p>
<p>このメニュー項目を使わなくても、読み込みたいファイルをこの設定ウィンドウにドラッグ＆ドロップして読み込ませることもできます。</p>
</li>
<li>
<p><strong>「すべての設定を元に戻す」／「すべての設定を既定値に戻す」</strong></p>
<p>「元に戻す」は、この設定ウィンドウが開かれたときの状態に戻します。「既定値に戻す」は、インストールした直後の初期状態（初期値）に戻します。どちらも、AppKey/HMKey と User-Agent ４項目を対象から除外することができます。</p>
</li>
<li>
<p><strong>「KeyとUAのみを消去」</strong></p>
<p>AppKey/HMKey と User-Agent ４項目の内容のみを消去して空欄にします。これらの設定を全て入れ替える場合など、古い入力内容が残っていると邪魔な場合などにご利用ください。</p>
</li>
<li>
<p><strong>「付属文書(README)」／「設定項目の解説」</strong></p>
<p>この 2ch API extension の付属説明書をブラウザウィンドウの新しいタブで開きます。</p>
<p>chaika の設定の 「ブラウザ」→「新しいタブを開いたとき、すぐにそのタブに切り替える」が OFF のときは、開かれた新しいタブが手前には来ませんので、目的のタブを手動で選択して手前へ持ってきてください。</p>
</li>
</ul>

      </div>
    
  </body>
</html>
